---
import { getCollection, type CollectionEntry } from "astro:content";
import ArticlePage from "../../components/ArticlePage.astro";
import { getSeriesNavigation } from "../../utils";

export async function getStaticPaths() {
    const notes = await getCollection("notes", ({ data }) => {
        return import.meta.env.PROD ? data.status !== "draft" : true;
    });

    return notes.map((note) => {
        const { prev, next } = getSeriesNavigation(notes, note);
        return {
            params: { slug: note.data.slug },
            props: { note, prevNote: prev, nextNote: next },
        };
    });
}

interface Props {
    note: CollectionEntry<"notes">;
    prevNote: CollectionEntry<"notes"> | null;
    nextNote: CollectionEntry<"notes"> | null;
}

const { note, prevNote, nextNote } = Astro.props;
---

<ArticlePage
    entry={note}
    prevEntry={prevNote}
    nextEntry={nextNote}
    urlPrefix="/notes"
/>
